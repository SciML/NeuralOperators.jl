<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Burgers Equation · NeuralOperators.jl</title><meta name="title" content="Burgers Equation · NeuralOperators.jl"/><meta property="og:title" content="Burgers Equation · NeuralOperators.jl"/><meta property="twitter:title" content="Burgers Equation · NeuralOperators.jl"/><meta name="description" content="Documentation for NeuralOperators.jl."/><meta property="og:description" content="Documentation for NeuralOperators.jl."/><meta property="twitter:description" content="Documentation for NeuralOperators.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralOperators/stable/tutorials/burgers/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralOperators/stable/tutorials/burgers/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralOperators/stable/tutorials/burgers/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralOperators.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralOperators.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralOperators.jl</a></li><li><span class="tocitem">Pre-built Models</span><ul><li><a class="tocitem" href="../../models/fno/">FNO</a></li><li><a class="tocitem" href="../../models/deeponet/">DeepONet</a></li><li><a class="tocitem" href="../../models/nomad/">NOMAD</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Burgers Equation</a><ul class="internal"><li><a class="tocitem" href="#Data-Loading"><span>Data Loading</span></a></li><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Training"><span>Training</span></a></li><li><a class="tocitem" href="#Plotting"><span>Plotting</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Burgers Equation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Burgers Equation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralOperators.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralOperators.jl/blob/main/docs/src/tutorials/burgers.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Burgers-Equation-using-DeepONet"><a class="docs-heading-anchor" href="#Burgers-Equation-using-DeepONet">Burgers Equation using DeepONet</a><a id="Burgers-Equation-using-DeepONet-1"></a><a class="docs-heading-anchor-permalink" href="#Burgers-Equation-using-DeepONet" title="Permalink"></a></h1><h2 id="Data-Loading"><a class="docs-heading-anchor" href="#Data-Loading">Data Loading</a><a id="Data-Loading-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Loading" title="Permalink"></a></h2><pre><code class="language-julia hljs">using DataDeps, MAT, MLUtils
using PythonCall, CondaPkg # For `gdown`
using Printf

const gdown = pyimport(&quot;gdown&quot;)

register(
    DataDep(
    &quot;Burgers&quot;,
    &quot;&quot;&quot;
    Burgers&#39; equation dataset from
    [fourier_neural_operator](https://github.com/zongyi-li/fourier_neural_operator)

    mapping between initial conditions to the solutions at the last point of time \
    evolution in some function space.

    u(x,0) -&gt; u(x, time_end):

      * `a`: initial conditions u(x,0)
      * `u`: solutions u(x,t_end)
    &quot;&quot;&quot;,
    &quot;https://drive.google.com/uc?id=16a8od4vidbiNR3WtaBPCSZ0T3moxjhYe&quot;,
    &quot;9cbbe5070556c777b1ba3bacd49da5c36ea8ed138ba51b6ee76a24b971066ecd&quot;;
    fetch_method=(url, local_dir) -&gt; begin
        pyconvert(String, gdown.download(url, joinpath(local_dir, &quot;Burgers_R10.zip&quot;)))
    end,
    post_fetch_method=unpack
)
)

filepath = joinpath(datadep&quot;Burgers&quot;, &quot;burgers_data_R10.mat&quot;)

const N = 2048
const Δsamples = 2^3
const grid_size = div(2^13, Δsamples)
const T = Float32

file = matopen(filepath)
x_data = reshape(T.(collect(read(file, &quot;a&quot;)[1:N, 1:Δsamples:end])), N, :, 1)
y_data = reshape(T.(collect(read(file, &quot;u&quot;)[1:N, 1:Δsamples:end])), N, :, 1)
close(file)

x_data = permutedims(x_data, (2, 1, 3))
grid = reshape(T.(collect(range(0, 1; length=grid_size)&#39;)), :, grid_size, 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×1024×1 Array{Float32, 3}:
[:, :, 1] =
 0.0  0.000977517  0.00195503  …  0.997067  0.998045  0.999022  1.0</code></pre><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Lux, NeuralOperators, Optimisers, Zygote, Random
using LuxCUDA

const cdev = cpu_device()
const gdev = gpu_device()

deeponet = DeepONet(;
    branch=(size(x_data, 1), ntuple(Returns(32), 5)...),
    trunk=(size(grid, 1), ntuple(Returns(32), 5)...),
    branch_activation=tanh,
    trunk_activation=tanh
)
ps, st = Lux.setup(Random.default_rng(), deeponet) |&gt; gdev;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">((branch = (layer_1 = (weight = Float32[-0.076485746 -0.086048774 … 0.040839564 0.08038453; 0.07468024 0.06588744 … 0.08472049 -0.053931348; … ; -0.07646979 -0.028881056 … 0.021697415 0.047938034; -0.07934337 -0.005486243 … 0.08679401 -0.087804444], bias = Float32[-0.017751232, -0.017852183, -0.015846647, -0.020741466, -0.0025281347, 0.023531284, -0.030531388, 0.013879109, 0.009318065, 0.014125798  …  0.014478773, 0.0050763823, -0.021347515, -0.017282177, 0.01940034, 0.023202173, 0.0009591542, -0.013158739, 0.013839453, 0.029790744]), layer_2 = (weight = Float32[0.39385578 0.02220334 … 0.43270043 -0.50182474; 0.19748741 0.2653407 … -0.3467824 0.48387772; … ; -0.19916466 0.068749234 … -0.29525495 -0.32380423; 0.27133882 -0.48406613 … 0.3815049 0.013932203], bias = Float32[-0.036136117, 0.16345692, 0.054529194, 0.02794844, 0.0040022437, -0.14953643, -0.05014588, -0.13718323, -0.15256439, 0.0033055563  …  0.10133599, 0.1427134, -0.09321178, 0.0049454267, -0.08833067, 0.14534444, -0.0958075, 0.08570029, -0.16643262, 0.13989325]), layer_3 = (weight = Float32[0.09627023 -0.060399625 … -0.08697308 0.20666642; -0.23595399 0.4035368 … -0.32949278 -0.13622802; … ; -0.39178264 0.3861428 … 0.11984258 -0.42515704; -0.4907821 0.41176987 … -0.45805845 0.3812141], bias = Float32[0.17613286, -0.00911826, -0.060374245, 0.087087736, -0.16647568, 0.14044261, 0.050120927, 0.004096547, 0.01264201, 0.16772671  …  0.122463234, 0.12862748, 0.08225263, -0.10573696, -0.035696547, 0.16246887, -0.0086964965, 0.058660258, 0.06428733, -0.08060344]), layer_4 = (weight = Float32[0.3781486 0.24687959 … -0.42323166 -0.30745783; 0.47732124 -0.09264394 … 0.13963732 -0.20297231; … ; -0.10867637 0.06605814 … 0.26404005 0.10435729; 0.34740084 -0.1343931 … 0.14743493 -0.12178865], bias = Float32[0.13250762, 0.04474929, -0.15279542, 0.115301974, -0.11075355, 0.101534605, -0.029054057, -0.15930879, -0.11910208, -0.098783344  …  -0.16925253, -0.15888365, 0.11360255, 0.12892723, -0.17568204, -0.015244094, 0.05407961, 0.059955683, 0.023301454, -0.01194821]), layer_5 = (weight = Float32[0.10058467 0.21568982 … -0.24043228 -0.19247754; 0.22390252 0.06333847 … -0.08154833 0.2926205; … ; 0.2560568 -0.29411316 … 0.23526527 0.29212403; 0.21439396 0.14924249 … 0.15036274 0.22986959], bias = Float32[-0.06778566, 0.009795244, 0.05192614, 0.13738705, -0.059493396, 0.05316374, 0.061829448, 0.026660305, 0.02112025, -0.049566697  …  -0.015524264, 0.14457263, -0.09398311, 0.010334281, -0.11871625, 0.16132338, -0.03820538, 0.14740328, -0.10073101, -0.054317173])), trunk = (layer_1 = (weight = Float32[-1.4704099; 0.9936735; … ; -1.7928846; 0.1341337;;], bias = Float32[-0.46877158, -0.06004429, 0.6982262, 0.3865292, -0.79099476, -0.37153876, 0.92085457, -0.1255399, 0.8094957, 0.6757394  …  0.27102304, 0.9149288, -0.63341856, 0.6507598, 0.2868184, -0.69695485, -0.57600856, 0.054338217, -0.67987037, -0.8199414]), layer_2 = (weight = Float32[0.41346383 -0.27135032 … 0.14891234 0.26442873; 0.104387954 0.16327573 … -0.33398438 -0.37794533; … ; -0.474496 -0.50090057 … -0.18319355 0.029935125; -0.32050106 -0.27004027 … 0.33501276 -0.29509842], bias = Float32[-0.087917276, 0.15849078, 0.08666581, 0.08038333, -0.07410236, 0.063992575, 0.09716703, 0.11016227, -0.036826063, 0.16536118  …  -0.11066001, -0.12996998, 0.067865215, -0.033657927, -0.13303754, -0.071013875, 0.04708625, 0.0075178808, 0.15020815, -0.02301964]), layer_3 = (weight = Float32[0.13910607 0.11099723 … -0.18103597 0.1668182; -0.43098497 -0.42333156 … -0.433511 -0.26800376; … ; 0.43105426 -0.31982392 … -0.003755814 0.14974813; -0.36226076 -0.23725192 … 0.29688826 -0.33911437], bias = Float32[-0.032235067, 0.04535041, 0.0046134153, -0.17251559, -0.093923345, -0.16503048, -0.17565915, -0.02838409, 0.058549263, 0.078531444  …  0.010256182, -0.005252003, -0.12723036, 0.08543988, 0.1274267, 0.12008874, -0.11734595, -0.07205912, -0.16238685, -0.13211952]), layer_4 = (weight = Float32[0.20057721 0.40573284 … 0.19446805 -0.42244095; -0.101956 -0.0526724 … 0.43298528 -0.41185775; … ; 0.12983306 -0.19469556 … 0.14089793 -0.14391686; 0.07885354 0.1512621 … -0.49442375 0.36531588], bias = Float32[-0.11698153, 0.111275285, 0.03440869, 0.12425725, -0.046302885, -0.1709399, -0.1546116, -0.03744339, 0.024772717, 0.04693667  …  -0.0819486, -0.06577066, -0.04133921, -0.043170784, -0.009208307, -0.10925407, 0.10794999, 0.025586888, 0.16031401, 0.14375584]), layer_5 = (weight = Float32[-0.010706324 0.21886265 … -0.23003373 0.25835416; -0.18078285 0.29087776 … -0.017626477 -0.035509225; … ; 0.28298566 -0.2951125 … 0.10309187 -0.030232677; 0.16710056 -0.0592242 … 0.29415163 -0.15725349], bias = Float32[0.015111268, -0.115901515, 0.03186681, -0.016196065, -0.16835116, 0.042647995, 0.015845023, -0.16776192, -0.15097687, 0.08720303  …  0.13624418, 0.14302173, 0.11233172, -0.048492163, 0.14266863, 0.08074725, 0.020195084, -0.1751627, -0.06889033, -0.17090322])), additional = NamedTuple()), (branch = (layer_1 = NamedTuple(), layer_2 = NamedTuple(), layer_3 = NamedTuple(), layer_4 = NamedTuple(), layer_5 = NamedTuple()), trunk = (layer_1 = NamedTuple(), layer_2 = NamedTuple(), layer_3 = NamedTuple(), layer_4 = NamedTuple(), layer_5 = NamedTuple()), additional = NamedTuple()))</code></pre><h2 id="Training"><a class="docs-heading-anchor" href="#Training">Training</a><a id="Training-1"></a><a class="docs-heading-anchor-permalink" href="#Training" title="Permalink"></a></h2><pre><code class="language-julia hljs">x_data_dev = x_data |&gt; gdev
y_data_dev = y_data |&gt; gdev
grid_dev = grid |&gt; gdev

function loss_function(model, ps, st, ((v, y), u))
    û, stₙ = model((v, y), ps, st)
    return MAELoss()(û, u), stₙ, (;)
end

function train_model!(model, ps, st, data; epochs=5000)
    train_state = Training.TrainState(model, ps, st, Adam(0.0001f0))

    for epoch in 1:epochs
        _, loss, _, train_state = Training.single_train_step!(
            AutoZygote(), loss_function, data, train_state)

        if epoch % 25 == 1 || epoch == epochs
            @printf(&quot;Epoch %d: loss = %.6e\n&quot;, epoch, loss)
        end
    end

    return train_state.parameters, train_state.states
end

ps_trained, st_trained = train_model!(
    deeponet, ps, st, ((x_data_dev, grid_dev), y_data_dev))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">((branch = (layer_1 = (weight = Float32[-0.081009254 -0.090079494 … 0.035321385 0.07536441; 0.07017042 0.061461095 … 0.080082186 -0.058512084; … ; -0.0747311 -0.027078718 … 0.023240054 0.049590103; -0.071261466 0.0027676823 … 0.09444451 -0.07992445], bias = Float32[-0.104428, -0.11543814, -0.05276328, 0.026600244, -0.1202278, -0.10424365, -0.103736594, 0.059927057, 0.1837584, 0.008192447  …  0.07187059, -0.1211637, 0.07137355, -0.07473968, 0.004163036, 0.09974768, 0.016040236, 0.02688201, 0.023559673, -0.057795204]), layer_2 = (weight = Float32[0.36544263 0.034739945 … 0.41897005 -0.50695395; 0.16943647 0.25013044 … -0.35517967 0.44563976; … ; -0.20044222 0.09034357 … -0.28481454 -0.3186732; 0.25389636 -0.45423034 … 0.381811 0.025119795], bias = Float32[-0.030254835, 0.2879379, 0.12577072, 0.12563235, 0.020880966, -0.27753198, -0.04435246, -0.16883366, -0.099955656, 0.012299296  …  0.21933694, 0.1448921, -0.22190131, 0.06658985, -0.046345443, 0.16153012, -0.26705354, 0.23738293, -0.26960027, 0.17069602]), layer_3 = (weight = Float32[0.098219275 -0.054409865 … -0.09793527 0.21316238; -0.22707008 0.40806893 … -0.38295844 0.0107234; … ; -0.34492788 0.4508342 … 0.10159057 -0.41314426; -0.50199836 0.4101809 … -0.46078718 0.3737574], bias = Float32[0.1872152, 0.05873598, -0.10502588, 0.19392057, -0.15437879, 0.139065, -0.045600574, 0.039433647, -0.10407624, 0.13427456  …  0.048671536, 0.16624464, 0.023699109, -0.12457891, -0.06478039, 0.24753787, -0.14982508, 0.07003642, 0.21423782, -0.0135620255]), layer_4 = (weight = Float32[0.39575875 0.24287605 … -0.39289382 -0.36798495; 0.5657462 -0.092555635 … 0.14051767 -0.2161579; … ; -0.13143592 0.06643652 … 0.2653009 0.09824769; 0.284229 -0.14036833 … 0.086972944 -0.09484141], bias = Float32[0.30710942, 0.047848497, -0.060586818, 0.16174068, -0.22200465, 0.04018728, 0.1000746, -0.20084907, -0.15962054, -0.13917814  …  -0.15231521, 0.0012075491, 0.14689408, 0.17046663, -0.17730954, -0.029451681, 0.016007371, -0.00927264, -0.034314137, -0.1711408]), layer_5 = (weight = Float32[0.11894579 0.22425568 … -0.22158615 -0.16348809; 0.22892563 0.067288466 … -0.10030068 0.30990732; … ; 0.2933232 -0.2886498 … 0.20935774 0.30697247; 0.2485395 0.14185275 … 0.1546299 0.22954607], bias = Float32[-0.089104116, 0.024813822, -0.021018501, 0.15977617, -0.064005665, 0.064087465, 0.013180519, 0.059650183, 0.06190025, -0.1353327  …  0.019566264, 0.10819819, -0.14508481, -0.10510417, -0.12088145, 0.17036918, -0.061735313, 0.19547698, -0.0057597547, -0.04129117])), trunk = (layer_1 = (weight = Float32[-1.4688531; 1.0406257; … ; -1.7423849; 0.14646788;;], bias = Float32[-0.48944032, -0.019592695, 0.6797789, 0.39849824, -0.8236114, -0.3937637, 0.90370834, -0.11669843, 0.8268058, 0.6735565  …  0.23186186, 0.9551238, -0.662464, 0.6429617, 0.30761003, -0.6619105, -0.5991954, 0.032147788, -0.63246125, -0.8014696]), layer_2 = (weight = Float32[0.426337 -0.2772853 … 0.16268808 0.27918804; 0.13907968 0.14524874 … -0.2975865 -0.33897573; … ; -0.48235127 -0.49975112 … -0.19164842 0.019814793; -0.32459375 -0.2679741 … 0.33061585 -0.29894152], bias = Float32[-0.10248178, 0.119549826, 0.085262224, 0.063376926, -0.061763406, 0.062098328, 0.10014255, 0.11879367, -0.04731183, 0.1650876  …  -0.10873342, -0.13344224, 0.05897169, -0.038616445, -0.13965148, -0.083364464, 0.036446944, 0.008097121, 0.16002925, -0.019329436]), layer_3 = (weight = Float32[0.12745835 0.20409365 … -0.15836065 0.14267123; -0.43096718 -0.43141326 … -0.4318555 -0.3101585; … ; 0.45039165 -0.33840358 … -0.018904267 0.14089485; -0.36582676 -0.238011 … 0.2992939 -0.3392253], bias = Float32[-0.009091833, 0.04742059, -0.00641715, -0.18117507, -0.10293012, -0.15900522, -0.1808057, -0.015508647, 0.045181245, 0.075376  …  0.012416836, -0.007903395, -0.12291924, 0.123529285, 0.124020204, 0.10033621, -0.09156961, -0.08903761, -0.17749807, -0.12923144]), layer_4 = (weight = Float32[0.17516571 0.4161282 … 0.2630951 -0.4573692; -0.108050406 -0.026514702 … 0.45584545 -0.44249874; … ; 0.14246045 -0.22031803 … 0.2616422 -0.19833401; 0.08641985 0.13129592 … -0.47789773 0.34420228], bias = Float32[-0.13839658, 0.10474619, 0.023903275, 0.13590075, -0.044455897, -0.14528848, -0.14174296, -0.029816562, 0.024004722, 0.051754825  …  -0.081340104, -0.089396134, -0.03508102, -0.043953024, 0.007968858, -0.11064867, 0.10390634, 0.032345094, 0.16930641, 0.14741018]), layer_5 = (weight = Float32[-0.021227311 0.2570728 … -0.23800772 0.25119832; -0.18621005 0.33943015 … -0.031675663 -0.03523495; … ; 0.28468883 -0.29243308 … 0.107928246 -0.025295958; 0.16379613 -0.032251824 … 0.27458295 -0.16755123], bias = Float32[0.0014204265, -0.12221059, 0.030545494, -0.03560216, -0.1715078, 0.04264064, -0.002506832, -0.13736482, -0.13031219, 0.093519315  …  0.14785059, 0.1435291, 0.107302, -0.0431395, 0.09868898, 0.075031415, 0.021742003, -0.1787564, -0.06189545, -0.17175113])), additional = NamedTuple()), (branch = (layer_1 = NamedTuple(), layer_2 = NamedTuple(), layer_3 = NamedTuple(), layer_4 = NamedTuple(), layer_5 = NamedTuple()), trunk = (layer_1 = NamedTuple(), layer_2 = NamedTuple(), layer_3 = NamedTuple(), layer_4 = NamedTuple(), layer_5 = NamedTuple())))</code></pre><h2 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h2><pre><code class="language-julia hljs">using CairoMakie

pred = first(deeponet((x_data_dev, grid_dev), ps_trained, st_trained)) |&gt; cdev

begin
    fig = Figure(; size=(1024, 1024))

    axs = [Axis(fig[i, j]) for i in 1:4, j in 1:4]
    for i in 1:4, j in 1:4
        idx = i + (j - 1) * 4
        ax = axs[i, j]
        l1 = lines!(ax, vec(grid), pred[idx, :, 1])
        l2 = lines!(ax, vec(grid), y_data[idx, :, 1])

        i == 4 &amp;&amp; (ax.xlabel = &quot;x&quot;)
        j == 1 &amp;&amp; (ax.ylabel = &quot;u(x)&quot;)

        if i == 1 &amp;&amp; j == 1
            axislegend(ax, [l1, l2], [&quot;Predictions&quot;, &quot;Ground Truth&quot;])
        end
    end
    linkaxes!(axs...)

    fig[0, :] = Label(fig, &quot;Burgers Equation using DeepONet&quot;; tellwidth=false, font=:bold)

    fig
end</code></pre><img src="b60d6b3f.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../models/nomad/">« NOMAD</a><a class="docs-footer-nextpage" href="../../api/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Sunday 29 December 2024 14:34">Sunday 29 December 2024</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
